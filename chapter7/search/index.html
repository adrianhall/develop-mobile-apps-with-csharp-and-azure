
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Adrian Hall">
      
      
        <link rel="canonical" href="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter7/search/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.14">
    
    
      
        <title>Azure Search - Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3de6f41f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/vs.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integrating-mobile-search" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" class="md-header__button md-logo" aria-label="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Azure Search
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" class="md-nav__button md-logo" aria-label="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Chapter 1 - Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 1 - Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Chapter 1 - Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1/firstapp_pc/" class="md-nav__link">
        Your First App - PC Edition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1/firstapp_mac/" class="md-nav__link">
        Your First App - Mac Edition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Chapter 2 - Authentication
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 2 - Authentication" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Chapter 2 - Authentication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/authconcepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/backend/" class="md-nav__link">
        Authentication in the Backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/enterprise/" class="md-nav__link">
        Enterprise Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/social/" class="md-nav__link">
        Social Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/debugging/" class="md-nav__link">
        Debugging Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/custom/" class="md-nav__link">
        Custom Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/authorization/" class="md-nav__link">
        Claims and Authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/realworld/" class="md-nav__link">
        Tokens in Real Apps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2/bestpractices/" class="md-nav__link">
        Best Practices
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Chapter 3 - Data Access and Offline Sync
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 3 - Data Access and Offline Sync" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Chapter 3 - Data Access and Offline Sync
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/dataconcepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/server/" class="md-nav__link">
        Implementing Table Controllers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/projection/" class="md-nav__link">
        Data Projection and Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/client/" class="md-nav__link">
        The Mobile Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/relationships/" class="md-nav__link">
        Relationships
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3/domainmgr/" class="md-nav__link">
        The Domain Manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Chapter 4 - Server Side Code
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 4 - Server Side Code" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Chapter 4 - Server Side Code
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4/options/" class="md-nav__link">
        Options for Server Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4/custom/" class="md-nav__link">
        Custom HTTP Endpoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4/webjobs/" class="md-nav__link">
        WebJobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4/recipes/" class="md-nav__link">
        Recipes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Chapter 5 - Push Notifications
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 5 - Push Notifications" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Chapter 5 - Push Notifications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5/concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5/android/" class="md-nav__link">
        Android Push
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5/ios/" class="md-nav__link">
        iOS Push
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5/windows/" class="md-nav__link">
        Windows Push
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5/recipes/" class="md-nav__link">
        Push Recipes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Chapter 6 - Combining Web and Mobile Apps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 6 - Combining Web and Mobile Apps" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Chapter 6 - Combining Web and Mobile Apps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6/mvc/" class="md-nav__link">
        MVC Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6/jquery/" class="md-nav__link">
        jQuery Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6/angular/" class="md-nav__link">
        Angular Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6/react/" class="md-nav__link">
        React Applications
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Chapter 7 - Other Useful Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 7 - Other Useful Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Chapter 7 - Other Useful Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/" class="md-nav__link">
        Useful Azure Services
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Azure Search
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Azure Search
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-azure-search" class="md-nav__link">
    Configuring Azure Search
  </a>
  
    <nav class="md-nav" aria-label="Configuring Azure Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-search-index" class="md-nav__link">
    Creating a Search Index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populating-a-search-index-the-easy-way" class="md-nav__link">
    Populating a Search Index (the easy way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-azure-search" class="md-nav__link">
    Testing Azure Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-service-considerations" class="md-nav__link">
    Other Service Considerations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-azure-search" class="md-nav__link">
    Using Azure Search
  </a>
  
    <nav class="md-nav" aria-label="Using Azure Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-vs-documentdb-vs-azure-search" class="md-nav__link">
    SQL vs. DocumentDB vs. Azure Search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../media/" class="md-nav__link">
        Media Services
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Chapter 8 - Developing An App
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 8 - Developing An App" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Chapter 8 - Developing An App
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter8/developing/" class="md-nav__link">
        The Development Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter8/testing/" class="md-nav__link">
        Testing your Application
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Chapter 9 - Going to Production
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chapter 9 - Going to Production" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Chapter 9 - Going to Production
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9/arm/" class="md-nav__link">
        Repeatable Deployments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9/appsvc/" class="md-nav__link">
        Safe Deployments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9/monitoring/" class="md-nav__link">
        Monitoring and Troubleshooting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../xamarin_tips/" class="md-nav__link">
        Xamarin Forms Tips
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../android_appendix/" class="md-nav__link">
        Android Developer Notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../vs_extensions/" class="md-nav__link">
        Visual Studio Extensions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../credits/" class="md-nav__link">
        Credits
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-azure-search" class="md-nav__link">
    Configuring Azure Search
  </a>
  
    <nav class="md-nav" aria-label="Configuring Azure Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-search-index" class="md-nav__link">
    Creating a Search Index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populating-a-search-index-the-easy-way" class="md-nav__link">
    Populating a Search Index (the easy way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-azure-search" class="md-nav__link">
    Testing Azure Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-service-considerations" class="md-nav__link">
    Other Service Considerations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-azure-search" class="md-nav__link">
    Using Azure Search
  </a>
  
    <nav class="md-nav" aria-label="Using Azure Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-vs-documentdb-vs-azure-search" class="md-nav__link">
    SQL vs. DocumentDB vs. Azure Search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/edit/master/docs/chapter7/search.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="integrating-mobile-search">Integrating Mobile Search<a class="headerlink" href="#integrating-mobile-search" title="Permanent link">&para;</a></h1>
<p>Simple search capabilities can be handled by a little light LINQ usage and a small
search bar.  However, most catalog apps or video apps have search that seems almost
magical in what it produces.  It can handle multiple languages, bad spelling, the
difference between singular and plural spellings.  Once it has a set of matches, the
order of the results is based on relevance to your search query and the app can
highlight and provide additional search queries.</p>
<p>All of this is provided by external search services.  The most commonly used services
are based on <a href="https://lucene.apache.org/">Lucene</a> which is an open-source text search engine library from the
Apache Project.  Azure Search is no exception here.  It provides a nice REST interface
that can be used by your app to provide search results.</p>
<p>In this chapters example, we are going to build something new and it doesn't use Azure
Mobile Apps much at all.  We are going to build a video search engine.  We will have a
number of videos that we will upload.  Those videos will be processed by the backend and
the audio and video content will be analyzed for searchable content.  Our app will be
able to search that content and get some matches back.</p>
<p>To start, I've created a simple Xamarin Forms app with a single view (called Search).
We'll update this app later on as we develop the code.  For now, the code for the app
is on the <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/tree/intro-ch7">GitHub repository</a>.</p>
<h2 id="configuring-azure-search">Configuring Azure Search<a class="headerlink" href="#configuring-azure-search" title="Permanent link">&para;</a></h2>
<p>My project does not depend on Azure Mobile Apps this time (yet).  Create a new Resource
Group, then click on the <strong>+ ADD</strong> button at the top of your resource group and add a
new <strong>Azure Search</strong> resource.  You will have to give it a name which becomes a part of
the URL.  All Azure Search resources are accessed through a https://<em>name</em>.search.windows.net
URL.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since your users will not be typing the name in, this is a great time to use a GUID
as the name - it fits the naming convention and is guaranteed to be unique.</p>
</div>
<p>The only other decision of note is the <strong>Pricing Tier</strong>.  You will be given the Standard
tier, which covers 15 million documents per partition and up to 12 partitions, with up
to 36 search units for scaling.  It's an awesome production service.  We are not exactly
at that level of need yet.  Fortunately, there is a free tier that covers a single scale
unit, 50MB of storage and 10,000 documents - plenty for testing the service out.</p>
<p><img alt="" src="../img/search-pricing.PNG" /></p>
<p>Click on the <strong>F Free</strong> option, then <strong>Select</strong>, followed by <strong>Create</strong> to create the
resource.  Creation of search resources is very quick - usually less than 15 seconds.</p>
<h3 id="creating-a-search-index">Creating a Search Index<a class="headerlink" href="#creating-a-search-index" title="Permanent link">&para;</a></h3>
<p>Just like Azure Mobile Apps, there is no data in the service yet, so it's fairly useless.  We
need to create an index that can be searched.  For right now, I've got a collection of videos.
These documents are JSON objects that include the following fields:</p>
<ul>
<li>Id</li>
<li>Title</li>
<li>Image</li>
<li>Rating</li>
<li>Release Year</li>
<li>Genre</li>
</ul>
<p>In Azure Search, the model for the objects going into the store need to have a type and you need
to decide on some attributes.  Exactly one field must be a "key" (we'll use the Id for this), and
fields need to be marked Retrievable, Filterable, Sortable, Facetable and/or Searchable.</p>
<ul>
<li>Retrievable - the app can retrieve the field</li>
<li>Sortable - it can be used to sort search results</li>
<li>Filterable - it can be used in filter queries</li>
<li>Searchable - it is a full-text search field</li>
</ul>
<p>The only one I've left out here is "Facet-able".  This allows a field to be used in faceted
navigation.  This is a drill-down mechanism.  If you have been on a web store like Amazon, you
will have seen this feature.  It's generally depicted as a "Refine by" field.  For example, you
may search for cars, but then want to limit the search to only convertibles, then only by red
cars.  Each of these refinements is a facet.  If I added a "genre" to my fields, I could use
faceted navigation.</p>
<p>Back to my model, here it is:</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Type</th>
<th>Attributes</th>
</tr>
</thead>
<tbody>
<tr>
<td>videoId</td>
<td>Edm.String</td>
<td>Key, Retrievable</td>
</tr>
<tr>
<td>title</td>
<td>Edm.String</td>
<td>Retrievable, Sortable, Filterable, Searchable</td>
</tr>
<tr>
<td>image</td>
<td>Edm.String</td>
<td>Retrievable</td>
</tr>
<tr>
<td>rating</td>
<td>Edm.Double</td>
<td>Retrievable, Sortable, Filterable</td>
</tr>
<tr>
<td>releaseYear</td>
<td>Edm.Int32</td>
<td>Retrievable, Sortable, Filterable</td>
</tr>
<tr>
<td>genre</td>
<td>Collection(Edm.String)</td>
<td>Retrievable, Filterable, Searchable, Facetable</td>
</tr>
</tbody>
</table>
<p>The types are based on <a href="http://docs.oasis-open.org/odata/odata/v4.0/errata03/os/complete/part3-csdl/odata-v4.0-errata03-os-part3-csdl-complete.html#_The_edm:Documentation_Element">OData v4 types</a>.  There are a large number of primitive types.  Unfortunately, Azure
Search only supports <a href="https://docs.microsoft.com/en-us/rest/api/searchservice/Supported-data-types">a subset of these</a>.</p>
<div class="admonition warn">
<p class="admonition-title">Warn</p>
<p>You can't sort by the genre field because it is a collection.  Collections cannot be marked sortable.</p>
</div>
<p>You can create an index via the Azure Portal or with the REST interface.  I'm going to define my
"videos" index with JSON.  Here is the JSON file:</p>
<pre><code class="language-text">{
    &quot;name&quot;: &quot;videos&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;videoId&quot;,
            &quot;type&quot;: &quot;Edm.String&quot;,
            &quot;key&quot;: true,
            &quot;filterable&quot;: false,
            &quot;searchable&quot;: false,
            &quot;sortable&quot;: false,
            &quot;facetable&quot;: false
        },
        {
            &quot;name&quot;: &quot;title&quot;,
            &quot;type&quot;: &quot;Edm.String&quot;,
            &quot;filterable&quot;: true,
            &quot;sortable&quot;: true,
            &quot;facetable&quot;: false
        },
        {
            &quot;name&quot;: &quot;image&quot;,
            &quot;type&quot;: &quot;Edm.String&quot;,
            &quot;filterable&quot;: false,
            &quot;searchable&quot;: false,
            &quot;sortable&quot;: false,
            &quot;facetable&quot;: false
        },
        {
            &quot;name&quot;: &quot;rating&quot;,
            &quot;type&quot;: &quot;Edm.Double&quot;,
            &quot;filterable&quot;: true,
            &quot;searchable&quot;: false,
            &quot;sortable&quot;: true,
            &quot;facetable&quot;: false
        },
        {
            &quot;name&quot;: &quot;releaseYear&quot;,
            &quot;type&quot;: &quot;Edm.Int32&quot;,
            &quot;filterable&quot;: true,
            &quot;searchable&quot;: false,
            &quot;sortable&quot;: true,
            &quot;facetable&quot;: false
        },
        {
            &quot;name&quot;: &quot;genre&quot;,
            &quot;type&quot;: &quot;Collection(Edm.String)&quot;,
            &quot;filterable&quot;: true,
            &quot;sortable&quot;: false,
            &quot;facetable&quot;: true
        }
    ]
}
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can skip default values.  Searchable and Retrievable default to true, so you only have to specify
them if you want to turn that off.  Similarly, key defaults to false, so you only have to specify the
key on the field that needs it.</p>
</div>
<p>To install this index, you will need the URI of the search service (which you already have) and the API Key.
In the <a href="https://portal.azure.com/">Azure Portal</a>, open your Azure Search resource and click on <strong>Keys</strong>.  You will see the primary
and secondary <strong>ADMIN KEY</strong>.  You can use either one.  Open up Postman and issue a POST to <code>URI/indexes?api-version=2016-09-01</code>.
Set the Content-Type to application/json and add an <code>api-key</code> header set to the admin key.  The content
of the POST should be your JSON object.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You can also install an index through the Azure Portal as a one time activity.  I like using REST
because it allows me to treat "configuration as code" and check my index definition into my source
repository.  This also opens up automated deployment options via PowerShell, for example.</p>
</div>
<p><img alt="" src="../img/search-createindex.PNG" /></p>
<p>Click on the <strong>SEND</strong> button and you will see the return status of <code>201 Created</code> and an OData v4 document
in the response body giving the full definition of the index.  You will receive a 400 series response with
an error message if something goes wrong.  It's likely to be either a duplicate index or a malformed JSON
object.</p>
<div class="admonition info">
<p class="admonition-title">Free Limits</p>
<p>You can create 1 free Azure Search instance and that supports 3 indices (or collections of documents).</p>
</div>
<h3 id="populating-a-search-index-the-easy-way">Populating a Search Index (the easy way)<a class="headerlink" href="#populating-a-search-index-the-easy-way" title="Permanent link">&para;</a></h3>
<p>There are many ways of populating a search index.  You can do what we are going to do - push data into an
index.  You can, however, also define an indexer that will crawl a data source periodically.  Indexers are
provided for Azure Blob and Table Storage, DocumentDB and SQL Server instances (through Azure SQL or SQL
Server on a VM).</p>
<p>I'm going to use a file from <a href="http://api.androidhive.info/json/movies.json">the Internet</a> to populate the search index. I had to adjust it as the format
for uploading is specific:</p>
<pre><code class="language-text">{
    &quot;value&quot;: [
        {
            &quot;title&quot;: &quot;Dawn of the Planet of the Apes&quot;,
            &quot;image&quot;: &quot;http://api.androidhive.info/json/movies/1.jpg&quot;,
            &quot;rating&quot;: 8.3,
            &quot;releaseYear&quot;: 2014,
            &quot;genre&quot;: [
                &quot;Action&quot;,
                &quot;Drama&quot;,
                &quot;Sci-Fi&quot;
            ],
            &quot;@search.action&quot;: &quot;upload&quot;,
            &quot;videoId&quot;: &quot;98ebe557-894c-48de-b61c-718f78b2adbb&quot;
        },
        {
            &quot;title&quot;: &quot;District 9&quot;,
            &quot;image&quot;: &quot;http://api.androidhive.info/json/movies/2.jpg&quot;,
            &quot;rating&quot;: 8,
            &quot;releaseYear&quot;: 2009,
            &quot;genre&quot;: [
                &quot;Action&quot;,
                &quot;Sci-Fi&quot;,
                &quot;Thriller&quot;
            ],
            &quot;@search.action&quot;: &quot;upload&quot;,
            &quot;videoId&quot;: &quot;e9d89038-386b-4aaa-a36c-530e2f3587c9&quot;
        },
        ...
    ]
}
</code></pre>
<p>I can upload this document just like the creation of the index.  The only difference is that I am POSTing
to /indexes/videos/docs/index:</p>
<p><img alt="" src="../img/search-createdoc.PNG" /></p>
<p>If you see a <strong>200 OK</strong>, then all the documents were uploaded and accepted.  If you see a <strong>207</strong> message,
then some of the documents were not uploaded.  In that case, look at the response - each document will be
referenced by the key field (in our case, the videoId field), the status field will be false and there will
be an errorMessage field which contains the problem.  You can correct the problem and upload just that
document.</p>
<p>There are four values for the <strong>@search.action</strong> field - normally, we will want to use "upload" for new
documents and "mergeOrUpload" for subsequent updates.</p>
<h3 id="testing-azure-search">Testing Azure Search<a class="headerlink" href="#testing-azure-search" title="Permanent link">&para;</a></h3>
<p>Now that we have a few documents indexed, we can test the search facility.  Go to the Overview page of your
search service.  The indices are listed on the overview page and you can click on the videos index.</p>
<p><img alt="" src="../img/search-overview.PNG" /></p>
<p>You can then click on the Search Explorer to get into the test facility.  Let's start with a fairly basic
search for the word "of" across all searchable fields:</p>
<p><img alt="" src="../img/search-all-of.PNG" /></p>
<p>We can also do boolean searches.  For example, let's do the same search, but finding only comedies:</p>
<p><img alt="" src="../img/search-of-comedy.PNG" /></p>
<p>Azure Search can accept a simple search string (as we have done here), an <a href="https://docs.microsoft.com/en-us/rest/api/searchservice/odata-expression-syntax-for-azure-search">OData Filter</a> using a restricted
set of search criteria, or <a href="https://docs.microsoft.com/en-us/rest/api/searchservice/lucene-query-syntax-in-azure-search">Lucene Search Syntax</a>.  The search explorer allows you to explore the various
search mechanisms and their (sometimes peculiar) syntax.</p>
<h3 id="other-service-considerations">Other Service Considerations<a class="headerlink" href="#other-service-considerations" title="Permanent link">&para;</a></h3>
<p>You will note the use of an API key for Azure Search.  This can (and should) be regenerated at a regular
interval.  As a result, you will want a custom API that retrieves the current API key, perhaps only giving
the API key to authenticated users.  We covered custom APIs in an earlier chapter, so I won't cover that
functionality here.  Instead, the demonstration code will use a <code>Settings.cs</code> class in the client that
contains the URI and API key for searching.</p>
<h2 id="using-azure-search">Using Azure Search<a class="headerlink" href="#using-azure-search" title="Permanent link">&para;</a></h2>
<p>Before you can use Azure Search, you should generate a Query-Only API key for your Azure Search service.  When
we uploaded the documents to the search service for indexing (and if you intend to do any other administrative
tasks through PowerShell or the REST API), you will use the Administrative API key.  This key is found under
the <strong>Keys</strong> menu item in the Azure Search resource in the Azure Portal.  In the same place is a menu item called
<strong>Manage query keys</strong>.</p>
<p><img alt="" src="../img/search-querykey-1.PNG" /></p>
<p>The service creates one of these keys for you with an empty name.  I like to create a query key for each version
of the mobile software I release.  I can thus retire keys that are no longer in use.  To create a key:</p>
<ul>
<li>Click the <strong>+ Add</strong> button.</li>
<li>Enter a descriptive name (like "iOS v1.0", for example)</li>
<li>Click <strong>Create</strong>.</li>
</ul>
<p><img alt="" src="../img/search-querykey-2.PNG" /></p>
<p>You can now copy and paste the key into your settings file.  I have created a <code>Settings.cs</code> file in my shared
project:</p>
<pre><code class="language-csharp">using System;

namespace VideoSearch
{
    public static class Settings
    {
        public static string AzureSearchUri = &quot;https://zumbook.search.windows.net&quot;;

        /// &lt;summary&gt;
        /// Replace this with your API key from the Azure Search.  You should
        /// never check in code with an API key in it - read the key from an
        /// Azure App Service App Setting and then provide it to your mobile
        /// clients via a custom API.
        /// &lt;/summary&gt;
        public static string AzureSearchApiKey = &quot;88E95AB69AAAAB6FC5579E1CC40E7FC4&quot;;
    }
}
</code></pre>
<p>As we saw while we were testing the service, the search API is going to return a number of JSON objects.  We
can represent each return value with a model.  Here is my <code>Models/Movie.cs</code> model:</p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using Newtonsoft.Json;

namespace VideoSearch.Models
{
    public class Movie : SearchResult
    {
        [JsonProperty(PropertyName = &quot;videoId&quot;)]
        public string Id { get; set; }


        public string Title { get; set; }

        public Uri Image { get; set; }

        public double Rating { get; set; }

        public int ReleaseYear { get; set; }

        [JsonProperty(PropertyName = &quot;genre&quot;)]
        public List&lt;string&gt; Genres { get; set; }
    }
}
</code></pre>
<p>The <code>Models/SearchResult.cs</code> model adds the <code>@search.score</code> value that is returned in the search results:</p>
<pre><code class="language-csharp">using Newtonsoft.Json;

namespace VideoSearch.Models
{
    public class SearchResult
    {
        [JsonProperty(PropertyName = &quot;@search.score&quot;)]
        public double SearchScore { get; set; }
    }
}
</code></pre>
<p>Finally, the <code>Models/MovieResults.cs</code> class can be used to deserialize the entire JSON object that is returned by the
server:</p>
<pre><code class="language-csharp">using System.Collections.Generic;
using Newtonsoft.Json;

namespace VideoSearch.Models
{
    public class MovieResults
    {
        [JsonProperty(PropertyName = &quot;@odata.context&quot;)]
        public string Context { get; set; }

        [JsonProperty(PropertyName = &quot;value&quot;)]
        public List&lt;Movie&gt; Movies { get; set; }
    }
}
</code></pre>
<p>I also provide a class called <code>Services/SearchService.cs</code> for handling search results.  In this case, it will
do the HTTP request to the specified server, sending the provided search string, and decode the response.  It
will throw an exception if the server produces an error:</p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Threading.Tasks;
using Newtonsoft.Json;
using VideoSearch.Models;

namespace VideoSearch.Services
{
    public class SearchService
    {
        private HttpClient _client;
        private string _apiVersion = &quot;2016-09-01&quot;;

        public SearchService()
        {
            this._client = new HttpClient();
        }

        public async Task&lt;List&lt;Movie&gt;&gt; SearchMoviesAsync(string searchTerms)
        {
            var content = await SearchAsync(&quot;videos&quot;, searchTerms);
            var movieResults = JsonConvert.DeserializeObject&lt;MovieResults&gt;(content);
            return movieResults.Movies;
        }

        private async Task&lt;string&gt; SearchAsync(string index, string searchTerms)
        {
            var uri = new UriBuilder($&quot;{Settings.AzureSearchUri}/indexes/{index}/docs&quot;);
            uri.Query = $&quot;api-version={_apiVersion}&amp;search={Uri.EscapeDataString(searchTerms)}&quot;;

            var request = new HttpRequestMessage
            {
                RequestUri = uri.Uri,
                Method = HttpMethod.Get
            };

            request.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(&quot;application/json&quot;));
            request.Headers.Add(&quot;api-key&quot;, Settings.AzureSearchApiKey);

            var response = await _client.SendAsync(request);
            return await response.Content.ReadAsStringAsync();
        }
    }
}
</code></pre>
<p>The <code>SearchAsync()</code> method is a basic HTTP GET method that returns a string.  We add the appropriate
headers and ensure the URI is the correct format.  </p>
<p>This service class can now be used to search for movies when we type something into the search box and
initiate a search.  This is done in the <code>ViewModels\Search.cs</code> class in the shared project:</p>
<pre><code class="language-csharp">    public Command SearchCommand =&gt; _cmdSearch ?? (_cmdSearch = new Command(async () =&gt; await ExecuteSearchCommand()));

    private async Task ExecuteSearchCommand()
    {
        if (IsBusy)
            return;
        IsBusy = true;

        try
        {
            var results = await _service.SearchMoviesAsync(SearchString);
            SearchResults.ReplaceRange(results);
        }
        catch (Exception ex)
        {
            SearchResults.Clear();
            await Application.Current.MainPage.DisplayAlert(&quot;Search Failed&quot;, ex.Message, &quot;OK&quot;);
        }
        finally
        {
            IsBusy = false;
        }
    }
</code></pre>
<p>The <code>SearchString</code> is a bindable string property that is bound to the Text field of the search 
bar.  The <code>SearchResults</code> property is an <code>ObservableRangeCollection</code> that is bound to a list of
items.</p>
<p>This code creates a reference to our search service, then uses it to populate the search results PropertyName
with the list of movies when the search is complete.  We also needed a little bit of error handling for the
edge case when the user types something in that isn't understood by the search service.  This is likely to
be rare, but we want to handle failures gracefully when they do happen.</p>
<p>The associated view must also be adjusted so that the movies are displayed.  This is done within a <code>ListView</code>
object in a similar way to the way we did our task list examples:</p>
<pre><code class="language-xml">&lt;ListView
    CachingStrategy=&quot;RecycleElement&quot;
    IsPullToRefreshEnabled=&quot;False&quot;
    ItemsSource=&quot;{Binding SearchResults}&quot;
    RowHeight=&quot;50&quot;
    SelectedItem=&quot;{Binding SelectedItem, Mode=TwoWay}&quot;&gt;

    &lt;ListView.BackgroundColor&gt;
        &lt;OnPlatform
            x:TypeArguments=&quot;Color&quot;
            Android=&quot;#2E2F30&quot;
            WinPhone=&quot;#F0F0F0&quot;
            iOS=&quot;#F0F0F0&quot; /&gt;
    &lt;/ListView.BackgroundColor&gt;

    &lt;ListView.ItemTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;ViewCell&gt;
                &lt;StackLayout
                    Padding=&quot;10&quot;
                    HorizontalOptions=&quot;FillAndExpand&quot;
                    Orientation=&quot;Horizontal&quot;
                    VerticalOptions=&quot;CenterAndExpand&quot;&gt;
                    &lt;StackLayout.BackgroundColor&gt;
                        &lt;OnPlatform
                            x:TypeArguments=&quot;Color&quot;
                            Android=&quot;Black&quot;
                            WinPhone=&quot;White&quot;
                            iOS=&quot;White&quot; /&gt;
                    &lt;/StackLayout.BackgroundColor&gt;
                    &lt;Label
                        HorizontalOptions=&quot;FillAndExpand&quot;
                        Text=&quot;{Binding Title}&quot;
                        TextColor=&quot;#272832&quot;&gt;
                        &lt;Label.TextColor&gt;
                            &lt;OnPlatform
                                x:TypeArguments=&quot;Color&quot;
                                Android=&quot;#F3F3F3&quot;
                                WinPhone=&quot;#272832&quot;
                                iOS=&quot;#272832&quot; /&gt;
                        &lt;/Label.TextColor&gt;
                    &lt;/Label&gt;
                &lt;/StackLayout&gt;
            &lt;/ViewCell&gt;
        &lt;/DataTemplate&gt;
    &lt;/ListView.ItemTemplate&gt;
&lt;/ListView&gt;
</code></pre>
<p>We can now run this application and start using the search service!  In the <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/tree/main/Chapter7">example code</a>, I've also included
a Details panel.  This should show you all the information within a movie title from the search results by clicking
on the movie title.  It's similar in construction to the task details pane from our task list example.</p>
<h3 id="sql-vs-documentdb-vs-azure-search">SQL vs. DocumentDB vs. Azure Search<a class="headerlink" href="#sql-vs-documentdb-vs-azure-search" title="Permanent link">&para;</a></h3>
<p>You may be wondering at this point why you should use Azure Search as an addition to SQL databases or DocumentDB.
After all, all three options store data, allow you to update that data, and provide access to JSON documents.  So
why would I not just place all my data in a searchable index and use that instead?</p>
<p>The Azure Search facility is designed for full-text searching of data, not rapid updates from multiple sources.  As
a result of this focus, it has no ability to do offline synchronization or conflict resolution, and it is lazy about
inserts (data inserted may not be available straight away).  It is not a good repository if your common practice is 
to work with the full data set and it is most definitely not the right source if you have more than one client with
the potential to update records at the same time.  It's primarily driven by a need to provide fast search results.  </p>
<p>DocumentDB and SQL Azure (via Azure Mobile Apps) are are the inverse of this.  They are designed for concurrent and
rapid updates to the data, with built-in conflict handling, incremental offline sync and guaranteed atomic writes.
These are features that your mobile clients need when you are writing data.  Both DocumentDB and Azure Mobile Apps
also have security features for limiting data retrieval - something Azure Search does not have.</p>
<p>Use Azure Search when you want to do "shopping cart" or "reference data search" type functionality.  These use
cases have slow changing data sets that are changed behind the scenes by a single client.  Use Azure Mobile Apps
or DocumentDB when you want multiple clients to update the data set, or your mobile client updates have security
concerns.</p>
<!-- Images -->
<!-- Links -->

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../services/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Useful Azure Services" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Useful Azure Services
            </div>
          </div>
        </a>
      
      
        
        <a href="../media/" class="md-footer__link md-footer__link--next" aria-label="Next: Media Services" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Media Services
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2017-2020 Adrian Hall
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/adrianhall" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/FizzyInTheHall" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c2e1ee47.min.js"></script>
      
        <script src="../../js/highlight.pack.js"></script>
      
    
  </body>
</html>