
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter9/monitoring/">
      
      
        <meta name="author" content="Adrian Hall">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.6.2">
    
    
      
        <title>Monitoring and Troubleshooting - Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-e2807e330f.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-f78e5cb881.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/vs.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="red" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/" title="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Chapter 9 - Going to Production
                </span>
              
            
            Monitoring and Troubleshooting
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Chapter 1 - Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Chapter 1 - Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter1/firstapp_pc/" title="Your First App - PC Edition" class="md-nav__link">
      Your First App - PC Edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter1/firstapp_mac/" title="Your First App - Mac Edition" class="md-nav__link">
      Your First App - Mac Edition
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Chapter 2 - Authentication
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Chapter 2 - Authentication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/authconcepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/backend/" title="Authentication in the Backend" class="md-nav__link">
      Authentication in the Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/enterprise/" title="Enterprise Authentication" class="md-nav__link">
      Enterprise Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/social/" title="Social Authentication" class="md-nav__link">
      Social Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/debugging/" title="Debugging Authentication" class="md-nav__link">
      Debugging Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/custom/" title="Custom Authentication" class="md-nav__link">
      Custom Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/authorization/" title="Claims and Authorization" class="md-nav__link">
      Claims and Authorization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/realworld/" title="Tokens in Real Apps" class="md-nav__link">
      Tokens in Real Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/bestpractices/" title="Best Practices" class="md-nav__link">
      Best Practices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Chapter 3 - Data Access and Offline Sync
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Chapter 3 - Data Access and Offline Sync
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/dataconcepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/server/" title="Implementing Table Controllers" class="md-nav__link">
      Implementing Table Controllers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/projection/" title="Data Projection and Queries" class="md-nav__link">
      Data Projection and Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/client/" title="The Mobile Client" class="md-nav__link">
      The Mobile Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/relationships/" title="Relationships" class="md-nav__link">
      Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/domainmgr/" title="The Domain Manager" class="md-nav__link">
      The Domain Manager
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Chapter 4 - Server Side Code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Chapter 4 - Server Side Code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/options/" title="Options for Server Code" class="md-nav__link">
      Options for Server Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/custom/" title="Custom HTTP Endpoints" class="md-nav__link">
      Custom HTTP Endpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/webjobs/" title="WebJobs" class="md-nav__link">
      WebJobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/recipes/" title="Recipes" class="md-nav__link">
      Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Chapter 5 - Push Notifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Chapter 5 - Push Notifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/android/" title="Android Push" class="md-nav__link">
      Android Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/ios/" title="iOS Push" class="md-nav__link">
      iOS Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/windows/" title="Windows Push" class="md-nav__link">
      Windows Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/recipes/" title="Push Recipes" class="md-nav__link">
      Push Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Chapter 6 - Combining Web and Mobile Apps
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Chapter 6 - Combining Web and Mobile Apps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/mvc/" title="MVC Applications" class="md-nav__link">
      MVC Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/jquery/" title="jQuery Applications" class="md-nav__link">
      jQuery Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/angular/" title="Angular Applications" class="md-nav__link">
      Angular Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/react/" title="React Applications" class="md-nav__link">
      React Applications
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Chapter 7 - Other Useful Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Chapter 7 - Other Useful Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/services/" title="Useful Azure Services" class="md-nav__link">
      Useful Azure Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/search/" title="Azure Search" class="md-nav__link">
      Azure Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/media/" title="Media Services" class="md-nav__link">
      Media Services
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Chapter 8 - Developing An App
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Chapter 8 - Developing An App
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter8/developing/" title="The Development Environment" class="md-nav__link">
      The Development Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter8/testing/" title="Testing your Application" class="md-nav__link">
      Testing your Application
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked>
    
    <label class="md-nav__link" for="nav-10">
      Chapter 9 - Going to Production
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Chapter 9 - Going to Production
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../arm/" title="Repeatable Deployments" class="md-nav__link">
      Repeatable Deployments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appsvc/" title="Safe Deployments" class="md-nav__link">
      Safe Deployments
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Monitoring and Troubleshooting
      </label>
    
    <a href="./" title="Monitoring and Troubleshooting" class="md-nav__link md-nav__link--active">
      Monitoring and Troubleshooting
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#monitoring-your-backend" title="Monitoring your Backend" class="md-nav__link">
    Monitoring your Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-an-application-insights-instance" title="Create an Application Insights Instance" class="md-nav__link">
    Create an Application Insights Instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-application-insights-to-your-mobile-backend" title="Add Application Insights to your Mobile Backend" class="md-nav__link">
    Add Application Insights to your Mobile Backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-application-insights-data" title="Viewing Application Insights Data" class="md-nav__link">
    Viewing Application Insights Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-your-mobile-clients" title="Monitoring your Mobile Clients" class="md-nav__link">
    Monitoring your Mobile Clients
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crash-reporting" title="Crash Reporting" class="md-nav__link">
    Crash Reporting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" title="Best Practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#and-in-closing" title="And in closing" class="md-nav__link">
    And in closing
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../xamarin_tips/" title="Xamarin Forms Tips" class="md-nav__link">
      Xamarin Forms Tips
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../android_appendix/" title="Android Developer Notes" class="md-nav__link">
      Android Developer Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../vs_extensions/" title="Visual Studio Extensions" class="md-nav__link">
      Visual Studio Extensions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../credits/" title="Credits" class="md-nav__link">
      Credits
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#monitoring-your-backend" title="Monitoring your Backend" class="md-nav__link">
    Monitoring your Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-an-application-insights-instance" title="Create an Application Insights Instance" class="md-nav__link">
    Create an Application Insights Instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-application-insights-to-your-mobile-backend" title="Add Application Insights to your Mobile Backend" class="md-nav__link">
    Add Application Insights to your Mobile Backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-application-insights-data" title="Viewing Application Insights Data" class="md-nav__link">
    Viewing Application Insights Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-your-mobile-clients" title="Monitoring your Mobile Clients" class="md-nav__link">
    Monitoring your Mobile Clients
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crash-reporting" title="Crash Reporting" class="md-nav__link">
    Crash Reporting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" title="Best Practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#and-in-closing" title="And in closing" class="md-nav__link">
    And in closing
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/edit/master/docs/chapter9/monitoring.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                <h1 id="monitoring-and-troubleshooting">Monitoring and Troubleshooting<a class="headerlink" href="#monitoring-and-troubleshooting" title="Permanent link">&para;</a></h1>
<p>The last two topics are joined together - monitoring and troubleshooting.  There are many reasons for monitoring:</p>
<ul>
<li>To gain marketing information into your userbase.</li>
<li>To detect potential security threats.</li>
<li>To detect problems in your code.</li>
</ul>
<p>This latter reason is the reason most developers want to monitor their mobile app.  However, there is much to be gained from monitoring your mobile app for marketing purposes, and security should be a top-of-mind issue for everyone with an app that others use.  Security is generally monitored at the mobile backend.  Marketing information is gleaned from monitoring the usage of the mobile client, and problems can occur anywhere in your code base.</p>
<p>You should always monitor as close to your mobile backend as possible.  If you monitor your mobile backend from another provider (for example), you will be paying for network charges needlessly.  Except in rare cases (such as the recently advertised Amazon outages), the cloud provider will keep the cloud operating without any involvement from you.  Even in those cases where there is an outage at the cloud provider, you will not be able to prevent the outage simply by having monitoring elsewhere.</p>
<p>Since the preferred hosting platform for Azure Mobile Apps is Azure App Service, this means using the analytics platform provided by Azure.  This consists of two parts:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-overview">Application Insights</a> for monitoring and troubleshooting the mobile backend.</li>
<li><a href="https://mobile.azure.com/signup?utm_medium=referral_link&amp;utm_source=GitHub&amp;utm_campaign=ZUMO%20Book">Visual Studio Mobile Center</a> for monitoring and troubleshooting the mobile client.</li>
</ul>
<h2 id="monitoring-your-backend">Monitoring your Backend<a class="headerlink" href="#monitoring-your-backend" title="Permanent link">&para;</a></h2>
<p>There is a lot of <a href="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-monitor">monitoring built into Azure App Service</a>.  For these tools, you don't have to do anything.  They are always available.  However, there are certain pieces of information that are not going to be available.  For instance, you will not be able to correlate uploads with users since Azure App Service really doesn't know anything about users.  For this reason, it's a good idea to integrate <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-overview">Application Insights</a> into your mobile backend.  This is a two-step process:</p>
<ol>
<li>Create an Application Insights instance in your Azure resource group.</li>
<li>Add Application Insights to your mobile backend project.</li>
</ol>
<p>There is more to Application Insights than the basics we are going to cover here, including <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-api-custom-events-metrics">custom events</a>, <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-api-filtering-sampling">filtering</a>, and <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-scom">integration with other platforms</a>.  Application Insights is a powerful service and we will only be able to scratch the surface of it.</p>
<div class="admonition tip">
<p class="admonition-title">Automate Application Insights creation with ARM</p>
<p>Just like all other Azure resources, you can create an Application Insights with an automated deployment via an ARM template.</p>
</div>
<h3 id="create-an-application-insights-instance">Create an Application Insights Instance<a class="headerlink" href="#create-an-application-insights-instance" title="Permanent link">&para;</a></h3>
<p>Start by opening the <a href="https://portal.azure.com">Azure portal</a>, then:</p>
<ul>
<li>Open your resource group.</li>
<li>Click <strong>Add</strong>.</li>
<li>Search for then click <strong>Application Insights</strong>.</li>
<li>Click <strong>Create</strong>.</li>
<li>Enter a name for the resource.  Pick <strong>ASP.NET web application</strong> for the application type.</li>
<li>Select the nearest location to your mobile backend.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Application Insights isn't everywhere</p>
<p>Application Insights can only be placed in larger regions where storage and compute capacity is large.  That means your Application Insights will probably not be in the same location as your mobile backend.</p>
</div>
<ul>
<li>Once you have set the required configuration, click <strong>Create</strong>.</li>
</ul>
<p>There won't be any data until you have connected your mobile backend to the Application Insights resource.</p>
<h3 id="add-application-insights-to-your-mobile-backend">Add Application Insights to your Mobile Backend<a class="headerlink" href="#add-application-insights-to-your-mobile-backend" title="Permanent link">&para;</a></h3>
<p>Let's continue with our cloud backend that we developed for <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/tree/master/Chapter8/Backend">Chapter 8</a>.  Open your solution in Visual Studio, right-click the project and select <strong>Add</strong> -&gt; <strong>Application Insights Telemetry...</strong>.</p>
<p><img alt="" src="../img/add-ai.PNG" /></p>
<p>Once added, the configuration process will start.  Click <strong>Start Free</strong>.</p>
<p><img alt="" src="../img/add-ai-2.PNG" /></p>
<p>If you need to, select and authenticate to the right Azure account and select your subscription.  In the <strong>Resource</strong> drop-down, select the Application Insights resource you just created.  Then click <strong>Register</strong>.  This will add the appropriate NuGet packages to your project and configure most of what is required in the source code.  Once the process is complete, click <strong>Finish</strong>.</p>
<p>You can optionally enable trace collection.  This allows you to search the output from <code>System.Diagnostics</code>, enabling you to capture even more information.  Diagnostic data is generally verbose and slows the service down.  The free tier of Application Insights is limited to 1Gb/month, so this step is optional.</p>
<p>Your last remaining step is to publish your site to Azure App Service, which we have done many times during the course of the book.</p>
<h3 id="viewing-application-insights-data">Viewing Application Insights Data<a class="headerlink" href="#viewing-application-insights-data" title="Permanent link">&para;</a></h3>
<p>The Application Insights data is available through the <a href="https://portal.azure.com">Azure portal</a> or within Visual Studio.  Before we go any further, generate some Application Insights data by using your mobile app.  Once done, you can review the Application Insights data by right-clicking on your backend project and choosing <strong>Application Insights</strong> -&gt; <strong>Open Application Insights Portal</strong>.  The same page is available by clicking the Application Insights resource in your resource group.</p>
<p>Application Insights is constantly changing, so take some time to learn about the metrics and reports you can view using the portal.</p>
<h2 id="monitoring-your-mobile-clients">Monitoring your Mobile Clients<a class="headerlink" href="#monitoring-your-mobile-clients" title="Permanent link">&para;</a></h2>
<p>Monitoring your mobile client is important to gather usage and marketing data about your users.  You can also find out how your users are actually using your mobile app.  This allows you to target additional improvements in areas that people find useful and perhaps remove or improve areas that are less used.  To integrate monitoring, first create a <a href="https://mobile.azure.com/signup?utm_medium=referral_link&amp;utm_source=GitHub&amp;utm_campaign=ZUMO%20Book">Visual Studio Mobile Center</a> app as we described in the <a href="../../chapter8/testing/#distributing-your-mobile-client-to-beta-users">Testing</a> section.</p>
<ol>
<li>Return to the <a href="https://mobile.azure.com?utm_medium=referral_link&amp;utm_source=GitHub&amp;utm_campaign=ZUMO%20Book">Visual Studio Mobile Center</a> and select your app.</li>
<li>If you were at another beacon, click <strong>Getting Started</strong>.</li>
<li>Click <strong>Manage app</strong>.</li>
<li>Copy the App secret somewhere accessible - we will need it in a few moments.</li>
<li>Open the mobile app project in Visual Studio 2017 or Visual Studio for Mac.</li>
<li>Right-click the solution and select <strong>Manage NuGet Packages for Solution...</strong>.</li>
<li>Click <strong>Browse</strong>, then search for <strong>Microsoft.Azure.Mobile.Analytics</strong>.</li>
<li>Install the <code>Microsoft.Azure.Mobile.Analytics</code> package into the Android and iOS projects.</li>
</ol>
<p>Once the package(s) are installed, open <code>App.cs</code> in the shared project.  Add the <code>MobileCenter.Start</code> line at the start of the constructor:</p>
<pre><code class="csharp">using Microsoft.Azure.Mobile;
using Microsoft.Azure.Mobile.Analytics;
using TaskList.Abstractions;
using TaskList.Services;
using Xamarin.Forms;

namespace TaskList
{
    public class App : Application
    {
        public static ICloudService CloudService { get; set; }

        public App()
        {
            MobileCenter.Start(&quot;android=609b2734-0353-4e71-a654-fedd9df1632a&quot;, typeof(Analytics));

#if USE_MOCK_SERVICES
            CloudService = new MockCloudService();
#else
            CloudService = new AzureCloudService();
#endif
            MainPage = new NavigationPage(new Pages.EntryPage());
        }
    }
}
</code></pre>

<p>When you start your app, the analytics service will send a session start message to Visual Studio Mobile Center, allowing you to get basic demographics about your mobile app usage, such as how many distinct users you have, where they are located, and what device(s) they are using.  To get this level of information, visit the Analytics page in the Visual Studio Mobile Center portal.</p>
<p>You can get better analytics by defining custom events.  An event is a custom interaction with the content in your app that allows you to better understand your user's behavior.  For example, you may want to understand what sort of things your users are uploading - are they uploading from the camera or picking a picture?  You will not be able to get this information from the server.  The server will only be able to tell that the user uploaded a picture.  To use custom events, you can use the <code>trackEvent()</code> method, like this:</p>
<pre><code class="csharp">// at the top of the file:
// using Microsoft.Azure.Mobile.Analytics

Analytics.TrackEvent(&quot;FILE_UPLOAD&quot;, new Dictionary&lt;string, string&gt; {
    { &quot;Source&quot;, &quot;Camera&quot; },
    { &quot;FileName&quot;, &quot;pic1.jpg&quot; }
});  
</code></pre>

<p>To analyze custom events, go to the Events page in the Visual Studio Mobile Center portal.  The events are attached to a session so you can report on the number of distinct users using a camera for upload, for example.  Custom Events are limited by your imagination, but they do have a cost associated with them - each event does cost a small amount of bandwidth to the user.</p>
<div class="admonition tip">
<p class="admonition-title">Other Analytics Limits</p>
<p>You can only produce 200 custom event types per app.  The "FILE_UPLOAD" is an event type.  There is a total maximum of 256 characters per event type.  Each property name and value must be less than 64 characters.</p>
</div>
<h3 id="crash-reporting">Crash Reporting<a class="headerlink" href="#crash-reporting" title="Permanent link">&para;</a></h3>
<p>Once your application is out in the wild, whether it be with your beta testers, your employees or the general public via a public app store, you want to ensure it is working.  You can do all the testing available to you and there will still be some combination of factors that may cause your application to crash.  Your users will most likely just delete your application at that point, so it's a good idea to collect the cause of the crash before they do that.  </p>
<p>To integrate crash reporting, add the Mobile Center SDK to your project, then add a single line of code to your application.  We've already <a href="../../chapter8/testing/#distributing-your-mobile-client-to-beta-users">created a Visual Studio Mobile Center app</a> for beta distribution (which we covered above), so we'll use the same application.</p>
<ol>
<li>Return to the <a href="https://mobile.azure.com?utm_medium=referral_link&amp;utm_source=GitHub&amp;utm_campaign=ZUMO%20Book">Visual Studio Mobile Center</a> and select your app.</li>
<li>If you were at another beacon, click <strong>Getting Started</strong>.</li>
<li>Click <strong>Manage app</strong>.</li>
<li>Copy the App secret somewhere accessible - we will need it in a few moments.</li>
<li>Open the mobile app project in Visual Studio 2017 or Visual Studio for Mac.</li>
<li>Right-click the solution and select <strong>Manage NuGet Packages for Solution...</strong>.</li>
<li>Click <strong>Browse</strong>, then search for <strong>Microsoft.Azure.Mobile.Crashes</strong>.</li>
<li>Install the <code>Microsoft.Azure.Mobile.Crashes</code> package into the Android and iOS projects.</li>
</ol>
<p>If you have both an iOS and Android app, make note of BOTH app secrets - one from each app within Mobile Center.</p>
<p>Once the package(s) are installed, open <code>App.cs</code> in the shared project.  Add the <code>MobileCenter.Start</code> line at the start of the constructor:</p>
<pre><code class="csharp">using Microsoft.Azure.Mobile;
using Microsoft.Azure.Mobile.Analytics;
using Microsoft.Azure.Mobile.Crashes;
using TaskList.Abstractions;
using TaskList.Services;
using Xamarin.Forms;

namespace TaskList
{
    public class App : Application
    {
        public static ICloudService CloudService { get; set; }

        public App()
        {
            MobileCenter.Start(&quot;android=609b2734-0353-4e71-a654-fedd9df1632a&quot;, 
                typeof(Analytics), typeof(Crashes));

#if USE_MOCK_SERVICES
            CloudService = new MockCloudService();
#else
            CloudService = new AzureCloudService();
#endif
            MainPage = new NavigationPage(new Pages.EntryPage());
        }
    }
}
</code></pre>

<p>I am combining analytics with crash reporting here.  You can choose to integrate analytics, crash reporting or both by adjusting the <code>MobileCenter.Start()</code> call.  Replace the app secret placeholders with your app secrets.</p>
<p>Eventually, your app is going to crash.  When this happens, the crash will appear in the <strong>Crashes</strong> service within Mobile Center, allowing you to see what type of mobile device was being used, the version of the app being run and the stack trace of the app at that point.  Visual Studio Mobile Center also groups like crashes together so that you can see commonality between crashes and better target your bug fixing.  </p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<p>There is, thankfully, a short list of best practices to close out the book:</p>
<ul>
<li>Integrate Analytics and Crash Reporting in every mobile app.</li>
<li>Integrate Application Insights into your mobile backend.</li>
<li>Investigate every single crash reported by your mobile app.</li>
<li>Use UI Testing to re-create the crash.</li>
<li>Use a bug tracking system such as the one integrated into GitHub or Visual Studio Team Services.</li>
<li>Investigate every <em>500 Internal Server Error</em> produced by your mobile backend.  It means your server crashed.</li>
</ul>
<h2 id="and-in-closing">And in closing<a class="headerlink" href="#and-in-closing" title="Permanent link">&para;</a></h2>
<p>Thank you for taking the time to read this book.  I hope you found it informative.  </p>
<p>Now go and make awesome mobile apps!</p>
<p><img alt="" src="../img/the-end.jpg" /></p>
<!-- Images -->

<!-- Links -->
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../appsvc/" title="Safe Deployments" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Safe Deployments
              </span>
            </div>
          </a>
        
        
          <a href="../../xamarin_tips/" title="Xamarin Forms Tips" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Xamarin Forms Tips
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Adrian Hall
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/adrianhall" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/FizzyInTheHall" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-6b599127bc.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="../../js/highlight.pack.js"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-93366112-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>